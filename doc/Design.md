# مستندات طراحی و معماری سیستم (System Design Document)
**پروژه:** پیش‌بینی دیابت با یادگیری ماشین (MATLAB)  
**تاریخ:** دسامبر ۲۰۲۵  
**نسخه:** 1.0

---

## ۱. نمای کلی معماری (Architecture Overview)

این پروژه بر اساس الگوی **Pipeline (خط لوله)** طراحی شده است. داده‌ها از یک سمت وارد می‌شوند، مرحله‌به‌مرحله تمیز و پردازش شده، وارد مدل هوشمند می‌شوند و در نهایت نتایج و نمودارها خارج می‌شوند.  
ساختار فایل‌بندی به گونه‌ای است که کدها (Source Code)، داده‌ها (Data) و مستندات (Docs) کاملاً از هم تفکیک شده‌اند.

---

## ۲. ساختار درختی پروژه (Project Directory Structure)

ساختار نهایی پروژه شما باید دقیقاً به شکل زیر باشد:

```text
Diabetes_Project/
│
├── data/                          # [لایه داده]
│   └── diabetes.csv               # فایل دیتاست خام دانلود شده
│
├── doc/                           # [لایه مستندات]
│   ├── Project_Roadmap.md         # سند نیازمندی‌ها (PRD)
│   └── Design.md                  # همین سند فعلی
│
├── src/                           # [لایه منطق و سورس کد]
│   ├── load_data.m                # تابع بارگذاری داده
│   ├── preprocess.m               # تابع پیش‌پردازش و تمیزکاری
│   ├── train_model.m              # تابع آموزش الگوریتم
│   └── evaluate.m                 # تابع ارزیابی و تست
│
├── results/                       # [لایه خروجی]
│   ├── trained_model.mat          # فایل ذخیره شده مدل (برای استفاده‌های بعدی)
│   ├── confusion_matrix.png       # تصویر ذخیره شده ماتریس خطا
│   └── report.txt                 # گزارش متنی عملکرد
│
└── main.m                         # [مدیر اجرایی پروژه - Entry Point]
```

---

## ۳. تشریح دقیق اجزا (Component Details)

در این بخش، وظیفه هر فایل و محتویات داخلی آن (بدون نوشتن کد) توضیح داده می‌شود.

### الف) فایل اصلی: `main.m`

- **نقش:** رهبر ارکستر. این فایل هیچ تابع پیچیده‌ای ندارد.
- **جریان داخلی:**
  - تنظیمات اولیه (پاک کردن حافظه `clc`, `clear`).
  - تعریف مسیر فایل‌ها (Path setup).
  - فراخوانی تابع `load_data` از پوشه `src`.
  - فراخوانی تابع `preprocess`.
  - فراخوانی تابع `train_model`.
  - فراخوانی تابع `evaluate`.
  - نمایش پیام «پایان پروژه».

### ب) پوشه `src/` (Source Code)

#### ۱. فایل `src/load_data.m`

- **وظیفه:** خواندن امن فایل CSV و فرمت‌دهی اولیه.
- **ورودی:** مسیر فایل (`filepath`).
- **خروجی:** متغیر جدول (`raw_table`).
- **اجزای داخلی:**
  - تعریف نام ستون‌ها (Header) به صورت دستی (چون فایل خام هدر ندارد).
  - استفاده از `readtable` با تنظیمات `PreserveVariableNames`.
  - بررسی اینکه آیا فایل وجود دارد یا خیر (Error Handling).

#### ۲. فایل `src/preprocess.m`

- **وظیفه:** تبدیل داده‌های خام به داده‌های قابل‌فهم برای ماشین.
- **ورودی:** جدول خام (`raw_table`).
- **خروجی:** چهار متغیر: `X_train`, `Y_train` (برای آموزش) و `X_test`, `Y_test` (برای تست).
- **اجزای داخلی:**
  - **مدیریت مقادیر صفر:** ستون‌های گلوکز، فشار خون و BMI نباید صفر باشند. این صفرها با میانگین همان ستون جایگزین می‌شوند (Imputation).
  - **جداسازی ویژگی و هدف:** جدا کردن ستون `Outcome` (هدف) از بقیه (ویژگی‌ها).
  - **نرمال‌سازی (Normalization):** استاندارد کردن اعداد (مثلاً تبدیل همه اعداد به بازه ۰ تا ۱ یا Z-Score) تا ویژگی‌های با اعداد بزرگ، مدل را منحرف نکنند.
  - **تقسیم (Splitting):** استفاده از تابع `cvpartition` برای تقسیم تصادفی ۷۰٪ به ۳۰٪.

#### ۳. فایل `src/train_model.m`

- **وظیفه:** یادگیری الگوها.
- **ورودی:** `X_train`, `Y_train`.
- **خروجی:** شیء مدل آموزش‌دیده (`trainedModel`).
- **اجزای داخلی:**
  - تعریف الگوریتم (در اینجا: KNN یا Decision Tree).
  - فیت کردن مدل روی داده‌های آموزشی (`fitcknn` یا `fitctree`).

#### ۴. فایل `src/evaluate.m`

- **وظیفه:** امتحان گرفتن از مدل.
- **ورودی:** `trainedModel`, `X_test`, `Y_test`.
- **خروجی:** نمایش نمودارها و چاپ دقت.
- **اجزای داخلی:**
  - پیش‌بینی روی داده‌های تست (`predict`).
  - محاسبه Accuracy (تعداد درست / کل داده‌ها).
  - رسم Confusion Matrix (ماتریس درهم‌ریختگی) برای دیدن تعداد مثبت/منفی کاذب.

### ج) پوشه `results/`

این پوشه در ابتدا خالی است. کدها طوری نوشته می‌شوند که اگر این پوشه نبود، آن را بسازند و خروجی‌ها را در آن ذخیره کنند تا دسکتاپ شما شلوغ نشود.

---

## ۴. جریان داده (Data Flow)

جریان کلی داده در سیستم به صورت زیر است:

```text
[diabetes.csv] 
      ⬇
(load_data.m)     --> [Table Object]
      ⬇
(preprocess.m)    --> [Cleaned Matrices (Train/Test)]
      ⬇
(train_model.m)   --> [Model Object]
      ⬇
(evaluate.m)      --> [Accuracy %] + [Plots]
```

---

## ۵. نیازمندی‌های سیستم (Requirements)

- **نرم‌افزار:** MATLAB (نسخه R2018b یا بالاتر)
- **تولباکس‌ها:** Statistics and Machine Learning Toolbox
- **سیستم‌عامل:** Windows / macOS / Linux (یا استفاده از MATLAB Online)


