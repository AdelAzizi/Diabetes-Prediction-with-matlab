# ุชูุถุญ ูุงู `optimize_model.m`

ุงู ุชุงุจุน ูุณุฆูู **ุจูููโุณุงุฒ ุฎูุฏฺฉุงุฑ ูพุงุฑุงูุชุฑูุง ูุฏู** ุงุณุช.  
ุจู ุฌุง ุงู ฺฉู ูุง ุฏุณุช ูพุงุฑุงูุชุฑูุง ุฑุง ุชูุธู ฺฉููุ ุงู ุชุงุจุน ุจุง ุงุณุชูุงุฏู ุงุฒ ุงูฺฏูุฑุชูโูุง ููุดููุฏ (ูุซู Bayesian Optimization) ุจูุชุฑู ููุงุฏุฑ ุฑุง ูพุฏุง ูโฺฉูุฏ.

---

## ูุฑูุฏ ู ุฎุฑูุฌ

- **ูุฑูุฏโูุง:**
  - `modelName`: ูุงู ูุฏู (ูุซูุงู `'KNN'`, `'Tree'`, `'SVM'`, `'Ensemble'`)
  - `X_train`: ุฏุงุฏูโูุง ุขููุฒุด (ูฺฺฏโูุง)
  - `Y_train`: ุจุฑฺุณุจโูุง ุขููุฒุด (ุฌูุงุจ ุฏุฑุณุช)
- **ุฎุฑูุฌ (`finalModel`)**: ูุฏู ุจููู ุดุฏู ุจุง ุจูุชุฑู ูพุงุฑุงูุชุฑูุง

---

## ูุฑุญููโุจูโูุฑุญูู ฺู ฺฉุงุฑ ูโฺฉูุฏุ

### ฑ. ุชูุธู ฺฏุฒููโูุง ุจูููโุณุงุฒ
ฺฏุฒููโูุง ูุซู ุชุนุฏุงุฏ ุชฺฉุฑุงุฑ ู ููุน ุงูฺฏูุฑุชู ุจูููโุณุงุฒ ุชูุธู ูโุดููุฏ.

### ฒ. ุงูุชุฎุงุจ ููุน ูุฏู
ุจุฑ ุงุณุงุณ `modelName`ุ ููุน ูุฏู ู ูพุงุฑุงูุชุฑูุง ฺฉู ุจุงุฏ ุจููู ุดููุฏ ุงูุชุฎุงุจ ูโุดููุฏ.

### ณ. ุจูููโุณุงุฒ
ูุฏู ุจุง ูพุงุฑุงูุชุฑูุง ูุฎุชูู ุขููุฒุด ุฏุงุฏู ูโุดูุฏ ู ุจูุชุฑู ุชุฑฺฉุจ ุงูุชุฎุงุจ ูโุดูุฏ.

---

## ุชูุถุญ ุฎุท ุจู ุฎุท ฺฉุฏ

```matlab
function finalModel = optimize_model(modelName, X_train, Y_train)
```
**ุฎุท ฑ:** ุชุนุฑู ุชุงุจุน. ุณู ูุฑูุฏ ูโฺฏุฑุฏ ู ฺฉ ูุฏู ุจููู ุดุฏู ุจุฑูโฺฏุฑุฏุงูุฏ.

```matlab
    % OPTIMIZE_MODEL ุจูููโุณุงุฒ ูพุงุฑุงูุชุฑูุง
    
    disp(' ');
    disp('-----------------------------------------');
    disp(['๐ง ูุฑุญูู ฒ: ุชููุช ูุฏู ' modelName]);
    disp('   (ุฏุฑ ุญุงู ูพุฏุง ฺฉุฑุฏู ุจูุชุฑู ุชูุธูุงุช...)');
    disp('-----------------------------------------');
```
**ุฎุท ฒ-ธ:** ฺฉุงููุช ุชูุถุญ ู ููุงุด ุนููุงู ูุฑุญูู. `['๐ง ูุฑุญูู ฒ: ุชููุช ูุฏู ' modelName]` ูุงู ูุฏู ุฑุง ุฏุฑ ูพุบุงู ูุฑุงุฑ ูโุฏูุฏ.

```matlab
    % ุชูุธูุงุช: ุชุนุฏุงุฏ ุชฺฉุฑุงุฑ ุฑุง ุงูุฒุงุด ูโุฏูู ุจุฑุง ุฏูุช ุจุดุชุฑ
    opts = struct('Optimizer', 'bayesopt', 'ShowPlots', false, ...
                  'MaxObjectiveEvaluations', 50, 'Verbose', 0);
```
**ุฎุท ฑฐ-ฑฒ:**
- `struct` ฺฉ ุณุงุฎุชุงุฑ ูโุณุงุฒุฏ ฺฉู ุดุงูู ุชูุธูุงุช ุจูููโุณุงุฒ ุงุณุช.
- `'Optimizer', 'bayesopt'` ุนู ุงุฒ Bayesian Optimization ุงุณุชูุงุฏู ฺฉู (ฺฉ ุงูฺฏูุฑุชู ููุดููุฏ).
- `'ShowPlots', false` ุนู ูููุฏุงุฑูุง ุจูููโุณุงุฒ ุฑุง ููุงุด ูุฏู (ุจุฑุง ุณุฑุนุช).
- `'MaxObjectiveEvaluations', 50` ุนู ุญุฏุงฺฉุซุฑ ตฐ ุจุงุฑ ูุฏู ุฑุง ุจุง ูพุงุฑุงูุชุฑูุง ูุฎุชูู ุงูุชุญุงู ฺฉู.
- `'Verbose', 0` ุนู ูพุบุงูโูุง ุงุถุงู ููุงุด ูุฏู.

```matlab
    switch modelName
```
**ุฎุท ฑด:** ฺฉ ุฏุณุชูุฑ `switch` ุดุฑูุน ูโุดูุฏ ฺฉู ุจุฑ ุงุณุงุณ `modelName` ุชุตูู ูโฺฏุฑุฏ ฺู ฺฉุงุฑ ุงูุฌุงู ุฏูุฏ.

```matlab
        case 'KNN'
```
**ุฎุท ฑต:** ุงฺฏุฑ `modelName` ุจุฑุงุจุฑ `'KNN'` ุจูุฏุ ุงู ุจุฎุด ุงุฌุฑุง ูโุดูุฏ.

```matlab
            finalModel = fitcknn(X_train, Y_train, ...
                'OptimizeHyperparameters', {'NumNeighbors', 'Distance'}, ...
                'HyperparameterOptimizationOptions', opts);
```
**ุฎุท ฑถ-ฑธ:** 
- `fitcknn` ฺฉ ูุฏู KNN ุขููุฒุด ูโุฏูุฏ.
- `'OptimizeHyperparameters', {'NumNeighbors', 'Distance'}` ุนู ุงู ุฏู ูพุงุฑุงูุชุฑ ุฑุง ุจููู ฺฉู:
  - `NumNeighbors`: ุชุนุฏุงุฏ ููุณุงูโูุง (ูุซูุงู ณุ ตุ ทุ ...)
  - `Distance`: ููุน ูุงุตูู (ูุซูุงู 'euclidean', 'cityblock', ...)
- `'HyperparameterOptimizationOptions', opts` ุชูุธูุงุช ุจูููโุณุงุฒ ุฑุง ุงุนูุงู ูโฺฉูุฏ.

```matlab
        case 'Tree'
```
**ุฎุท ฒฐ:** ุงฺฏุฑ `modelName` ุจุฑุงุจุฑ `'Tree'` ุจูุฏ.

```matlab
            finalModel = fitctree(X_train, Y_train, ...
                'OptimizeHyperparameters', {'MinLeafSize', 'MaxNumSplits'}, ...
                'HyperparameterOptimizationOptions', opts);
```
**ุฎุท ฒฑ-ฒณ:** 
- `fitctree` ฺฉ ุฏุฑุฎุช ุชุตูู ุขููุฒุด ูโุฏูุฏ.
- `'MinLeafSize'`: ุญุฏุงูู ุชุนุฏุงุฏ ููููู ุฏุฑ ูุฑ ุจุฑฺฏ (ูุฑฺู ฺฉูฺฺฉุชุฑุ ุฏุฑุฎุช ูพฺุฏูโุชุฑ).
- `'MaxNumSplits'`: ุญุฏุงฺฉุซุฑ ุชุนุฏุงุฏ ุชูุณูโูุง.

```matlab
        case 'SVM'
```
**ุฎุท ฒต:** ุงฺฏุฑ `modelName` ุจุฑุงุจุฑ `'SVM'` ุจูุฏ.

```matlab
            finalModel = fitcsvm(X_train, Y_train, ...
                'OptimizeHyperparameters', {'BoxConstraint'}, ...
                'KernelFunction', 'linear', 'Standardize', true, ...
                'HyperparameterOptimizationOptions', opts);
```
**ุฎุท ฒถ-ฒน:** 
- `fitcsvm` ฺฉ ูุฏู SVM ุขููุฒุด ูโุฏูุฏ.
- `'OptimizeHyperparameters', {'BoxConstraint'}` ุนู ููุท `BoxConstraint` ุฑุง ุจููู ฺฉู (ฺฉูุชุฑู ุณุฎุชโฺฏุฑ ูุฏู).
- `'KernelFunction', 'linear'` ุนู ุงุฒ ฺฉุฑูู ุฎุท ุงุณุชูุงุฏู ฺฉู.
- `'Standardize', true` ุนู ุฏุงุฏูโูุง ุฑุง ูุฑูุงู ฺฉู.

```matlab
        case 'Ensemble'
```
**ุฎุท ณฑ:** ุงฺฏุฑ `modelName` ุจุฑุงุจุฑ `'Ensemble'` ุจูุฏ.

```matlab
            % ุชูุธูุงุช ูุฎุตูุต ุฑูุฏูู ูุงุฑุณุช (ุชุนุฏุงุฏ ุฏุฑุฎุชโูุง ู ุงูุฏุงุฒู ุจุฑฺฏโูุง)
            finalModel = fitcensemble(X_train, Y_train, 'Method', 'Bag', ...
                'OptimizeHyperparameters', {'NumLearningCycles', 'MinLeafSize'}, ...
                'HyperparameterOptimizationOptions', opts);
```
**ุฎุท ณฒ-ณต:** 
- `fitcensemble` ฺฉ ูุฏู Ensemble (ูุซู Random Forest) ุขููุฒุด ูโุฏูุฏ.
- `'Method', 'Bag'` ุนู ุงุฒ ุฑูุด Bagging ุงุณุชูุงุฏู ฺฉู (Random Forest).
- `'NumLearningCycles'`: ุชุนุฏุงุฏ ุฏุฑุฎุชโูุง.
- `'MinLeafSize'`: ุญุฏุงูู ุชุนุฏุงุฏ ููููู ุฏุฑ ูุฑ ุจุฑฺฏ.

```matlab
        otherwise
```
**ุฎุท ณท:** ุงฺฏุฑ ูฺโฺฉุฏุงู ุงุฒ ููุงุฑุฏ ุจุงูุง ูุจูุฏ (ูุซูุงู `'NB'`).

```matlab
            % ุจุฑุง NB ุง ููุงุฑุฏ ูพุดโุจู ูุดุฏู
            disp('โ๏ธ ุงู ูุฏู ูุงุฒ ุจู ุชูุธู ุฎุงุต ูุฏุงุฑุฏ.');
            finalModel = fitcnb(X_train, Y_train);
```
**ุฎุท ณธ-ดฐ:** 
- ฺฉ ูพุบุงู ูุดุฏุงุฑ ููุงุด ูโุฏูุฏ.
- `fitcnb` ฺฉ ูุฏู Naive Bayes ุขููุฒุด ูโุฏูุฏ (ุจุฏูู ุจูููโุณุงุฒ).

```matlab
    end
```
**ุฎุท ดฑ:** ูพุงุงู ุฏุณุชูุฑ `switch`.

```matlab
    disp('โ ุจูููโุณุงุฒ ุชูุงู ุดุฏ.');
```
**ุฎุท ดณ:** ูพุบุงู ููููุช.

```matlab
end
```
**ุฎุท ดด:** ูพุงุงู ุชุงุจุน.

---

## ฺุฑุง ุจูููโุณุงุฒ ููู ุงุณุชุ

ูพุงุฑุงูุชุฑูุง ูุฏู ุชุงุซุฑ ุฒุงุฏ ุฑู ุฏูุช ุฏุงุฑูุฏ:

- **KNN**: ุงฺฏุฑ ุชุนุฏุงุฏ ููุณุงูโูุง ุฎู ฺฉู ุจุงุดุฏุ ูุฏู ุญุณุงุณ ูโุดูุฏ. ุงฺฏุฑ ุฎู ุฒุงุฏ ุจุงุดุฏุ ุฏูุช ฺฉู ูโุดูุฏ.
- **Tree**: ุงฺฏุฑ ุฏุฑุฎุช ุฎู ุนูู ุจุงุดุฏุ Overfitting ูโุดูุฏ. ุงฺฏุฑ ุฎู ฺฉู ุนูู ุจุงุดุฏุ ุฏูุช ฺฉู ูโุดูุฏ.
- **SVM**: `BoxConstraint` ฺฉูุชุฑู ูโฺฉูุฏ ฺฉู ูุฏู ฺูุฏุฑ ุณุฎุชโฺฏุฑ ุจุงุดุฏ.

ุจูููโุณุงุฒ ุฎูุฏฺฉุงุฑ ุงู ฺฉุงุฑ ุฑุง ุจุฑุง ูุง ุงูุฌุงู ูโุฏูุฏ ู ุจูุชุฑู ุชุฑฺฉุจ ุฑุง ูพุฏุง ูโฺฉูุฏ.

---

## ูฺฉุชู ููู

`'MaxObjectiveEvaluations', 10` ุนู ููุท ฑฐ ุจุงุฑ ุงูุชุญุงู ูโฺฉูุฏ (ุจุฑุง ุณุฑุนุช).  
ุงฺฏุฑ ูโุฎูุงูุฏ ุฏูุช ุจุดุชุฑ ุฏุงุดุชู ุจุงุดุฏุ ูโุชูุงูุฏ ุงู ุนุฏุฏ ุฑุง ุจุดุชุฑ ฺฉูุฏ (ูุซูุงู ณฐ ุง ตฐ)ุ ุงูุง ุฒูุงู ุจุดุชุฑ ุทูู ูโฺฉุดุฏ.

