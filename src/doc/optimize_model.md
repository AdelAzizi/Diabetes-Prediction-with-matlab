# ุชูุถุญ ูุงู `optimize_model.m`

ุงู ุชุงุจุน ูุณุฆูู **ุจูููโุณุงุฒ ุฎูุฏฺฉุงุฑ ูพุงุฑุงูุชุฑูุง ูุฏู Ensemble** ุงุณุช.  
ุจู ุฌุง ุงู ฺฉู ูุง ุฏุณุช ูพุงุฑุงูุชุฑูุง ุฑุง ุชูุธู ฺฉููุ ุงู ุชุงุจุน ุจุง ุงุณุชูุงุฏู ุงุฒ ุงูฺฏูุฑุชูโูุง ููุดููุฏ (ูุซู Bayesian Optimization) ุจูุชุฑู ููุงุฏุฑ ุฑุง ูพุฏุง ูโฺฉูุฏ.

---

## ูุฑูุฏ ู ุฎุฑูุฌ

- **ูุฑูุฏโูุง:**
  - `modelName`: ูุงู ูุฏู (ููุท `'Ensemble'` ูุฌุงุฒ ุงุณุช)
 - `X_train`: ุฏุงุฏูโูุง ุขููุฒุด (ูฺฺฏโูุง)
  - `Y_train`: ุจุฑฺุณุจโูุง ุขููุฒุด (ุฌูุงุจ ุฏุฑุณุช)
- **ุฎุฑูุฌ (`finalModel`)**: ูุฏู Ensemble ุจููู ุดุฏู ุจุง ุจูุชุฑู ูพุงุฑุงูุชุฑูุง

---

## ูุฑุญููโุจูโูุฑุญูู ฺู ฺฉุงุฑ ูโฺฉูุฏุ

### ฑ. ุชูุธู ฺฏุฒููโูุง ุจูููโุณุงุฒ
ฺฏุฒููโูุง ูุซู ุชุนุฏุงุฏ ุชฺฉุฑุงุฑ ู ููุน ุงูฺฏูุฑุชู ุจูููโุณุงุฒ ุชูุธู ูโุดููุฏ.

### ฒ. ุจุฑุฑุณ ูุงู ูุฏู
ุจุฑุฑุณ ูโฺฉูุฏ ฺฉู ุขุง `modelName` ุจุฑุงุจุฑ `'Ensemble'` ุงุณุช ุง ุฎุฑ.

### ณ. ุจูููโุณุงุฒ Ensemble
ูุฏู Ensemble ุจุง ูพุงุฑุงูุชุฑูุง ูุฎุชูู ุขููุฒุด ุฏุงุฏู ูโุดูุฏ ู ุจูุชุฑู ุชุฑฺฉุจ ุงูุชุฎุงุจ ูโุดูุฏ.

---

## ุชูุถุญ ุฎุท ุจู ุฎุท ฺฉุฏ

```matlab
function finalModel = optimize_model(modelName, X_train, Y_train)
```
**ุฎุท ฑ:** ุชุนุฑู ุชุงุจุน. ุณู ูุฑูุฏ ูโฺฏุฑุฏ ู ฺฉ ูุฏู ุจููู ุดุฏู ุจุฑูโฺฏุฑุฏุงูุฏ.

```matlab
    % OPTIMIZE_MODEL ุจูููโุณุงุฒ ูพุงุฑุงูุชุฑูุง ูุฏู Ensemble ุจู ุตูุฑุช ุชุฎุตุต
    
    disp(' ');
    disp('-----------------------------------------');
    disp(['๐ง ูุฑุญูู ต: ุชููุช ูุฏู ' modelName]);
    disp('   (ุฏุฑ ุญุงู ูพุฏุง ฺฉุฑุฏู ุจูุชุฑู ุชูุธูุงุช...)');
    disp('-----------------------------------------');
```
**ุฎุท ฒ-ธ:** ฺฉุงููุช ุชูุถุญ ู ููุงุด ุนููุงู ูุฑุญูู. `['๐ง ูุฑุญูู ต: ุชููุช ูุฏู ' modelName]` ูุงู ูุฏู ุฑุง ุฏุฑ ูพุบุงู ูุฑุงุฑ ูโุฏูุฏ.

```matlab
    % ุชูุธูุงุช ูพุดุฑูุชู: ุงูุฒุงุด ุชุนุฏุงุฏ ุงุฑุฒุงุจโูุง ุจุฑุง ุฏูุช ุจุดุชุฑ
    opts = struct('Optimizer', 'bayesopt', 'ShowPlots', false, ...
                  'MaxObjectiveEvaluations', 100, 'Verbose', 0);
```
**ุฎุท ฑฐ-ฑฒ:**
- `struct` ฺฉ ุณุงุฎุชุงุฑ ูโุณุงุฒุฏ ฺฉู ุดุงูู ุชูุธูุงุช ุจูููโุณุงุฒ ุงุณุช.
- `'Optimizer', 'bayesopt'` ุนู ุงุฒ Bayesian Optimization ุงุณุชูุงุฏู ฺฉู (ฺฉ ุงูฺฏูุฑุชู ููุดููุฏ).
- `'ShowPlots', false` ุนู ูููุฏุงุฑูุง ุจูููโุณุงุฒ ุฑุง ููุงุด ูุฏู (ุจุฑุง ุณุฑุนุช).
- `'MaxObjectiveEvaluations', 100` ุนู ุญุฏุงฺฉุซุฑ ฑฐฐ ุจุงุฑ ูุฏู ุฑุง ุจุง ูพุงุฑุงูุชุฑูุง ูุฎุชูู ุงูุชุญุงู ฺฉู (ุงูุฒุงุด ุฏุงุฏู ุดุฏู ุจุฑุง ุฏูุช ุจุดุชุฑ).
- `'Verbose', 0` ุนู ูพุบุงูโูุง ุงุถุงู ููุงุด ูุฏู.

```matlab
    % ููุท ุจุฑุง ูุฏู Ensemble ุงูุฌุงู ูโุฏูู
    if strcmp(modelName, 'Ensemble')
```
**ุฎุท ฑด-ฑต:** ุจุฑุฑุณ ูโฺฉูุฏ ฺฉู ุขุง ูุงู ูุฏู `'Ensemble'` ุงุณุช ุง ุฎุฑ.

```matlab
        % ุชูุธูุงุช ูพุดุฑูุชู ูุฎุตูุต ุฑูุฏูู ูุงุฑุณุช ุจุง ุจูููโุณุงุฒ ฺฏุณุชุฑุฏูโุชุฑ
        % ุงูุฒุงุด ุชุนุฏุงุฏ ุฏุฑุฎุชโูุง ู ุจูููโุณุงุฒ ุฏููโุชุฑ ูพุงุฑุงูุชุฑูุง ฺฉูุฏ
        finalModel = fitcensemble(X_train, Y_train, ...
            'Method', 'Bag', ...
            'NumLearningCycles', 300, ... % ุงูุฒุงุด ุชุนุฏุงุฏ ุฏุฑุฎุชโูุง
            'Template', templateTree('MinLeafSize', 1, 'MaxNumSplits', 100), ...
            'OptimizeHyperparameters', {'NumLearningCycles', 'LearnRate', 'template'}, ...
            'HyperparameterOptimizationOptions', opts);
```
**ุฎุท ฑถ-ฒณ:**
- `fitcensemble` ฺฉ ูุฏู Ensemble (ูุซู Random Forest) ุขููุฒุด ูโุฏูุฏ.
- `'Method', 'Bag'` ุนู ุงุฒ ุฑูุด Bagging ุงุณุชูุงุฏู ฺฉู (Random Forest).
- `'NumLearningCycles', 300` ุนู ณฐฐ ุฏุฑุฎุช (ุงูุฒุงุด ุงูุชู ุงุฒ ฒฐฐ ุจู ณฐฐ ุจุฑุง ุนููฺฉุฑุฏ ุจูุชุฑ).
- `'Template', templateTree(...)` ุชุนู ูโฺฉูุฏ ฺฉู ฺู ููุน ุฏุฑุฎุชโูุง ุฏุฑ Ensemble ุงุณุชูุงุฏู ุดููุฏ.
- `'MinLeafSize', 1` ุนู ุญุฏุงูู ฑ ููููู ุฏุฑ ูุฑ ุจุฑฺฏ (ุฏุฑุฎุชโูุง ูพฺุฏูโุชุฑ).
- `'MaxNumSplits', 100` ุนู ุญุฏุงฺฉุซุฑ ฑฐ ุชูุณู ุฏุฑ ูุฑ ุฏุฑุฎุช.
- `'OptimizeHyperparameters', {'NumLearningCycles', 'LearnRate', 'template'}` ุนู ุงู ูพุงุฑุงูุชุฑูุง ุฑุง ุจููู ฺฉู.
- `'LearnRate'` ูุฑุฎ ุงุฏฺฏุฑ ุจุฑุง ฺฉูุชุฑู ุชุฃุซุฑ ูุฑ ุฏุฑุฎุช.
- `'template'` ุดุงูู ูพุงุฑุงูุชุฑูุง ุฏุฑุฎุชโูุง ุฏุงุฎู Ensemble.

```matlab
        disp('โ ุจูููโุณุงุฒ Ensemble ุจุง ููููุช ุงูุฌุงู ุดุฏ.');
    else
        error('โ ุงู ุชุงุจุน ููุท ุจุฑุง ูุฏู Ensemble ุทุฑุงุญ ุดุฏู ุงุณุช.');
    end
```
**ุฎุท ฒด-ฒธ:** ุงฺฏุฑ ูุฏู `'Ensemble'` ูุจุงุดุฏุ ุฎุทุง ููุงุด ูโุฏูุฏ.

```matlab
end
```
**ุฎุท ฒน:** ูพุงุงู ุชุงุจุน.

---

## ฺุฑุง ุจูููโุณุงุฒ ููู ุงุณุชุ

ูพุงุฑุงูุชุฑูุง ูุฏู ุชุงุซุฑ ุฒุงุฏ ุฑู ุฏูุช ุฏุงุฑูุฏ:

- **Ensemble**: ุชุนุฏุงุฏ ุฏุฑุฎุชโูุง (`NumLearningCycles`)ุ ุงูุฏุงุฒู ุจุฑฺฏโูุง (`MinLeafSize`) ู ูุฑุฎ ุงุฏฺฏุฑ (`LearnRate`) ุชุงุซุฑ ูุณุชูู ุฑู ุฏูุช ู ุณุฑุนุช ูุฏู ุฏุงุฑูุฏ.
- ูุฏู Ensemble ฺฉู ุจู ุนููุงู ุจุฑูุฏู ุฏุฑ ููุงุณู ูุฏูโูุง ุงูุชุฎุงุจ ุดุฏุ ูุงุฒ ุจู ุจูููโุณุงุฒ ุฏูู ุฏุงุฑุฏ
- ุฒุฑุง ุงู ูุฏู ุชุฑฺฉุจ ุงุฒ ฺูุฏู ูุฏู ุณุงุฏู ุงุณุช ู ูพุงุฑุงูุชุฑูุง ุขู ูโุชูุงููุฏ ุนููฺฉุฑุฏ ููุง ุฑุง ุจู ุทูุฑ ฺุดูฺฏุฑ ุจูุจูุฏ ุฏููุฏ.
- ุจุง ุงูุฒุงุด ุชุนุฏุงุฏ ุฏุฑุฎุชโูุง ุจู ณฐฐ ู ุจูููโุณุงุฒ ฺฏุณุชุฑุฏูโุชุฑ ูพุงุฑุงูุชุฑูุงุ ูุฏู ูโุชูุงูุฏ ุนููฺฉุฑุฏ ุจูุชุฑ ุฏุงุดุชู ุจุงุดุฏ.

ุจูููโุณุงุฒ ุฎูุฏฺฉุงุฑ ุงู ฺฉุงุฑ ุฑุง ุจุฑุง ูุง ุงูุฌุงู ูโุฏูุฏ ู ุจูุชุฑู ุชุฑฺฉุจ ุฑุง ูพุฏุง ูโฺฉูุฏ.

---

## ูฺฉุงุช ููู ุจุฑุง ูุฏู Ensemble

- `'NumLearningCycles'` (ุชุนุฏุงุฏ ุฏุฑุฎุชโูุง): ณฐฐ ุฏุฑุฎุช ุจุฑุง ุนููฺฉุฑุฏ ุจูุชุฑ. ูุนูููุงู ุจู ตฐ ุชุง ตฐฐ ุงุณุช. ูุฑฺู ุจุดุชุฑ ุจุงุดุฏุ ุฏูุช ููฺฉู ุงุณุช ุงูุฒุงุด ุงุจุฏ ุงูุง ุฒูุงู ุจุดุชุฑ ูโุจุฑุฏ.
- `'MinLeafSize'` (ุญุฏุงูู ุงูุฏุงุฒู ุจุฑฺฏ): ฑ ููููู ุจุฑุง ุงุฌุงุฏ ุฏุฑุฎุชโูุง ูพฺุฏูโุชุฑ.
- `'MaxNumSplits'` (ุญุฏุงฺฉุซุฑ ุชุนุฏุงุฏ ุชูุณู): ฑฐฐ ุจุฑุง ฺฉูุชุฑู ูพฺุฏฺฏ ุฏุฑุฎุช.
- `'LearnRate'` (ูุฑุฎ ุงุฏฺฏุฑ): ฺฉูุชุฑู ูโฺฉูุฏ ฺฉู ูุฑ ุฏุฑุฎุช ฺูุฏุฑ ุชุฃุซุฑ ุฏุงุดุชู ุจุงุดุฏ.
- `'Method', 'Bag'` ุนู ุงุฒ ุฑูุด Bagging (Bootstrap Aggregating) ุงุณุชูุงุฏู ูโุดูุฏ ฺฉู ุจุฑุง Random Forest ููุงุณุจ ุงุณุช.
- ูุฏู Ensemble ุจุง ุจูููโุณุงุฒ ูพุงุฑุงูุชุฑูุง ูโุชูุงูุฏ ุนููฺฉุฑุฏ ุจุณุงุฑ ุจูุชุฑ ูุณุจุช ุจู ูุฏูโูุง ุชฺฉ ุฏุงุดุชู ุจุงุดุฏ.
- ุงู ูุฏู ุฏุฑ ุชุดุฎุต ุฏุงุจุช ุจุณุงุฑ ูุคุซุฑ ุงุณุช ุฒุฑุง ุชุฑฺฉุจ ฺูุฏู ูุฏู ุณุงุฏู ูโุชูุงูุฏ ุงูฺฏููุง ูพฺุฏูโุชุฑ ุฑุง ุดูุงุณุง ฺฉูุฏ.

---

## ูฺฉุชู ููู

`'MaxObjectiveEvaluations', 100` ุนู ุญุฏุงฺฉุซุฑ ฑฐฐ ุจุงุฑ ุงูุชุญุงู ูโฺฉูุฏ (ุจุฑุง ุชุนุงุฏู ุจู ุฏูุช ู ุฒูุงู).  
ุงฺฏุฑ ูโุฎูุงูุฏ ุฏูุช ุจุดุชุฑ ุฏุงุดุชู ุจุงุดุฏุ ูโุชูุงูุฏ ุงู ุนุฏุฏ ุฑุง ุจุดุชุฑ ฺฉูุฏุ ุงูุง ุฒูุงู ุจุดุชุฑ ุทูู ูโฺฉุดุฏ.
