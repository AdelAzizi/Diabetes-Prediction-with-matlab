# ุชูุถุญ ูุงู `evaluate_model.m`

ุงู ุชุงุจุน ูุณุฆูู **ุงุฑุฒุงุจ ููุง ูุฏู** ุงุณุช.  
ุฏูุช (Accuracy) ุฑุง ูุญุงุณุจู ูโฺฉูุฏุ ูุนุงุฑูุง ูพุฒุดฺฉ ููู ูุซู Sensitivityุ Precisionุ Specificity ู F1-Score ุฑุง ูู ุญุณุงุจ ูโฺฉูุฏ ู ูููุฏุงุฑูุง ุงุณุชุงูุฏุงุฑุฏ ูุซู ROC Curve ู Confusion Matrix ุฑุง ุฑุณู ูโฺฉูุฏ.

---

## ูุฑูุฏ ู ุฎุฑูุฌ

- **ูุฑูุฏโูุง:**
  - `model`: ูุฏู ุขููุฒุด ุฏุฏู (ูุซูุงู ุงุฒ `fitcknn` ุง `fitctree`)
  - `X_test`: ุฏุงุฏูโูุง ุชุณุช (ูฺฺฏโูุง)
  - `Y_test`: ุจุฑฺุณุจโูุง ูุงูุน ุชุณุช (ุฌูุงุจ ุฏุฑุณุช)
- **ุฎุฑูุฌ:**  
  - ุฎุฑูุฌ ูุณุชูู (ูุชุบุฑ) ุจุฑููโฺฏุฑุฏุงูุฏุ ุงูุง ูุชุงุฌ ุฑุง ุฏุฑ ูพูุฌุฑู ฺฉุงููุฏ ููุงุด ูโุฏูุฏ ู ูููุฏุงุฑูุง ุฑุง ุฑุณู ูโฺฉูุฏ.

---

## ูุฑุญููโุจูโูุฑุญูู ฺู ฺฉุงุฑ ูโฺฉูุฏุ

### ฑ. ูพุดโุจู
ูุฏู ุฑู ุฏุงุฏูโูุง ุชุณุช ูพุดโุจู ูโฺฉูุฏ ู ูู ฺฉูุงุณ (ฐ ุง ฑ) ู ูู ุงุญุชูุงู (Score) ุฑุง ุจุฑูโฺฏุฑุฏุงูุฏ.

### ฒ. ูุญุงุณุจู ูุงุชุฑุณ ุฎุทุง (Confusion Matrix)
ุงุฒ ุฑู ูพุดโุจูโูุง ู ุฌูุงุจโูุง ูุงูุนุ ฺฉ ูุงุชุฑุณ ฒรฒ ุณุงุฎุชู ูโุดูุฏ ฺฉู ูโฺฏูุฏ:
- ฺูุฏ ุชุง ุณุงูู ุฏุฑุณุช ุชุดุฎุต ุฏุงุฏู ุดุฏ (TN)
- ฺูุฏ ุชุง ุณุงูู ุงุดุชุจุงู ุชุดุฎุต ุฏุงุฏู ุดุฏ (FP)
- ฺูุฏ ุชุง ุจูุงุฑ ุงุดุชุจุงู ุชุดุฎุต ุฏุงุฏู ุดุฏ (FN)
- ฺูุฏ ุชุง ุจูุงุฑ ุฏุฑุณุช ุชุดุฎุต ุฏุงุฏู ุดุฏ (TP)

### ณ. ูุญุงุณุจู ูุนุงุฑูุง ูุฎุชูู
- **Accuracy**: ุฏูุช ฺฉู
- **Sensitivity**: ูุฏุฑุช ฺฉุดู ุจูุงุฑุงู (ููุงู Recall)
- **Precision**: ููุช ูโฺฏูุฏ ุจูุงุฑ ุงุณุชุ ฺูุฏุฑ ุงุญุชูุงู ุฏุงุฑุฏ ูุงูุนุงู ุจูุงุฑ ุจุงุดุฏ
- **Specificity**: ูุฏุฑุช ุชุดุฎุต ุณุงููโูุง
- **F1-Score**: ูุงูฺฏู ูุงุฑูููฺฉ Precision ู Sensitivity
- **AUC Score**: ูุณุงุญุช ุฒุฑ ููุญู ROC

### ด. ููุงุด ฺฏุฒุงุฑุด ูุชู
ููู ูุนุงุฑูุง ุจู ุตูุฑุช ุฌุฏูู ุฏุฑ ูพูุฌุฑู ฺฉุงููุฏ ููุงุด ุฏุงุฏู ูโุดููุฏ.

### ต. ุฑุณู ูููุฏุงุฑูุง
- **Confusion Matrix**: ูุงุชุฑุณ ุฎุทุง ุจู ุตูุฑุช ุจุตุฑ
- **ROC Curve**: ูููุฏุงุฑ ุนููฺฉุฑุฏ ูุฏู ุฏุฑ ุขุณุชุงููโูุง ูุฎุชูู

---

## ุชูุถุญ ุฎุท ุจู ุฎุท ฺฉุฏ

```matlab
function evaluate_model(model, X_test, Y_test)
```
**ุฎุท ฑ:** ุชุนุฑู ุชุงุจุน. ุณู ูุฑูุฏ ูโฺฏุฑุฏ ู ุฎุฑูุฌ ุจุฑููโฺฏุฑุฏุงูุฏ.

```matlab
    % EVALUATE_MODEL ูุณุฎู ุชูุฒ ู ููุง
    % ุฎุฑูุฌ: ููุท ุฌุฏูู ุดุงุฎุตโูุง ู ูููุฏุงุฑูุง ุงุณุชุงูุฏุงุฑุฏ
    
    disp(' ');
    disp('๐ ูุชุงุฌ ุงุฑุฒุงุจ ููุง (Final Results)');
    disp('--------------------------------------');
```
**ุฎุท ฒ-ท:** ฺฉุงููุช ุชูุถุญ ู ููุงุด ุนููุงู ูุฑุญูู.

```matlab
    %% ฑ. ูพุดโุจู
    [Y_pred, scores] = predict(model, X_test);
    cm = confusionmat(Y_test, Y_pred);
    
    % ุงุณุชุฎุฑุงุฌ ููุงุฏุฑ ูุงุชุฑุณ
    TN = cm(1,1); FP = cm(1,2);
    FN = cm(2,1); TP = cm(2,2);
```
**ุฎุท น-ฑถ:**
- `predict` ูุฏู ุฑุง ุฑู ุฏุงุฏูโูุง ุชุณุช ุงุฌุฑุง ูโฺฉูุฏ.
- `Y_pred` ูพุดโุจู ฺฉูุงุณโูุง ุงุณุช (ฐ ุง ฑ).
- `scores` ุงุญุชูุงู ุชุนูู ุจู ูุฑ ฺฉูุงุณ ุงุณุช (ูุซูุงู [0.3, 0.7] ุนู ณฐูช ุงุญุชูุงู ุณุงูู ู ทฐูช ุงุญุชูุงู ุจูุงุฑ).
- `confusionmat` ูุงุชุฑุณ ุฎุทุง ุฑุง ูุญุงุณุจู ูโฺฉูุฏ.
- `cm` ฺฉ ูุงุชุฑุณ ฒรฒ ุงุณุช.
- `TN` (True Negative): ุณุงูู ุฏุฑุณุช ุชุดุฎุต ุฏุงุฏู ุดุฏ.
- `FP` (False Positive): ุณุงูู ุงุดุชุจุงู ุชุดุฎุต ุฏุงุฏู ุดุฏ (ูุดุฏุงุฑ ุบูุท).
- `FN` (False Negative): ุจูุงุฑ ุงุดุชุจุงู ุชุดุฎุต ุฏุงุฏู ุดุฏ (ุฎุทุฑูุงฺฉ! ฺูู ุจูุงุฑ ุฑุง ุณุงูู ุชุดุฎุต ุฏุงุฏู).
- `TP` (True Positive): ุจูุงุฑ ุฏุฑุณุช ุชุดุฎุต ุฏุงุฏู ุดุฏ.

```matlab
    %% ฒ. ูุญุงุณุจุงุช ุดุงุฎุตโูุง
    accuracy    = (TP + TN) / sum(cm(:));
    sensitivity = TP / (TP + FN);   % ูุฏุฑุช ุชุดุฎุต ุจูุงุฑ
    specificity = TN / (TN + FP);   % ูุฏุฑุช ุชุดุฎุต ุณุงูู
    precision   = TP / (TP + FP);
    f1_score    = 2 * (precision * sensitivity) / (precision + sensitivity);
    
    % ูุญุงุณุจู AUC (ุณุทุญ ุฒุฑ ูููุฏุงุฑ)
    [Xroc, Yroc, ~, AUC] = perfcurve(Y_test, scores(:,2), 1);
```
**ุฎุท ฑท-ฒต:**
- `accuracy` ุฏูุช ฺฉู ุฑุง ูุญุงุณุจู ูโฺฉูุฏ.
- `sensitivity` (ููุงู recall) ูุฏุฑุช ฺฉุดู ุจูุงุฑุงู ุฑุง ูโุณูุฌุฏ (TP / (TP + FN)).
- `specificity` ูุฏุฑุช ุชุดุฎุต ุณุงููโูุง ุฑุง ูโุณูุฌุฏ (TN / (TN + FP)).
- `precision` ุฏูุช ูพุดโุจู ูุซุจุช ุฑุง ูโุณูุฌุฏ (TP / (TP + FP)).
- `f1_score` ูุงูฺฏู ูุงุฑูููฺฉ precision ู sensitivity ุงุณุช.
- `perfcurve` ุจุฑุง ูุญุงุณุจู AUC (ูุณุงุญุช ุฒุฑ ููุญู ROC) ุงุณุชูุงุฏู ูโุดูุฏ.
- `[Xroc, Yroc, ~, AUC]` ููุงุท ROC ู ููุฏุงุฑ AUC ุฑุง ุจุฑูโฺฏุฑุฏุงูุฏ.

```matlab
    %% ณ. ููุงุด ุฌุฏูู ุชูุฒ
    fprintf('| %-15s | %-10s |\n', 'Metric', 'Value');
    fprintf('=================================\n');
    fprintf('| %-15s | %6.2f%%    |\n', 'Accuracy', accuracy*100);
    fprintf('| %-15s | %6.2f%%    |\n', 'Sensitivity', sensitivity*100);
    fprintf('| %-15s | %6.2f%%    |\n', 'Specificity', specificity*100);
    fprintf('| %-15s | %6.2f%%    |\n', 'F1-Score', f1_score*100);
    fprintf('| %-15s | %6.4f     |\n', 'AUC Score', AUC);
    fprintf('---------------------------------\n');
    fprintf('โ๏ธ ุชุนุฏุงุฏ ุจูุงุฑุงู ุชุดุฎุต ุฏุงุฏู ูุดุฏู (FN): %d ููุฑ\n', FN);
```
**ุฎุท ฒท-ณถ:**
- ฺฉ ุฌุฏูู ุจุง ุฏู ุณุชูู ูโุณุงุฒุฏ: "Metric" ู "Value".
- `%-15s` ุนู ฺฉ ุฑุดุชู ุจุง ุนุฑุถ ฑต ฺฉุงุฑุงฺฉุชุฑ ู ุชุฑุงุฒ ฺูพ.
- `accuracy*100` ุฏูุช ุฑุง ุฏุฑ ุตุฏ ูโฺฉูุฏ.
- `sensitivity` ุจู ุฌุง recall ุงุณุชูุงุฏู ุดุฏู ุงุณุช.
- `AUC` ุจู ุตูุฑุช ด ุฑูู ุงุนุดุงุฑ ููุงุด ุฏุงุฏู ูโุดูุฏ (ูู ุฏุฑุตุฏ).
- ุฎุท ุขุฎุฑ ุชุนุฏุงุฏ ุจูุงุฑุงู ฺฉู ุงุดุชุจุงู ุชุดุฎุต ุฏุงุฏู ุดุฏูโุงูุฏ (FN) ุฑุง ููุงุด ูโุฏูุฏ.

```matlab
    %% ด. ุฑุณู ูููุฏุงุฑูุง
    figure('Name', 'Final Evaluation', 'Color', 'w', 'Position', [100, 100, 900, 400]);
    
    % ุงูู) ูุงุชุฑุณ ุฎุทุง
    subplot(1, 2, 1);
    confusionchart(cm, {'Healthy', 'Diabetic'});
    title('Confusion Matrix');
    
    % ุจ) ูููุฏุงุฑ ROC
    subplot(1, 2, 2);
    plot(Xroc, Yroc, 'b-', 'LineWidth', 2); hold on;
    plot([0,1], [0,1], 'k--', 'LineWidth', 1); % ุฎุท ุดุงูุณ
    fill([Xroc; 1; 0], [Yroc; 0; 0], 'b', 'FaceAlpha', 0.1, 'EdgeColor', 'none');
    title(sprintf('ROC Curve (AUC = %.2f)', AUC));
    xlabel('False Positive Rate'); 
    ylabel('True Positive Rate');
    grid on;
    
    disp('โ ูููุฏุงุฑูุง ุฑุณู ุดุฏูุฏ.');
```
**ุฎุท ณธ-ตถ:**
- `figure` ฺฉ ูพูุฌุฑู ุฌุฏุฏ ุจุง ุงุจุนุงุฏ นฐฐรดฐฐ ูโุณุงุฒุฏ.
- `confusionchart` ูุงุชุฑุณ ุฎุทุง ุฑุง ุฑุณู ูโฺฉูุฏ.
- `subplot(1, 2, 1)` ุฒุฑูููุฏุงุฑ ุงูู ุฑุง ุงูุชุฎุงุจ ูโฺฉูุฏ.
- `plot` ููุญู ROC ุฑุง ุฑุณู ูโฺฉูุฏ ู ุฎุท ุชุตุงุฏู ุฑุง ุงุถุงูู ูโฺฉูุฏ.
- `fill` ูุงุญู ุฒุฑ ููุญู ROC ุฑุง ุฑูฺฏ ูโฺฉูุฏ.
- `title` ุนููุงู ูููุฏุงุฑ ROC ุฑุง ุจุง ููุฏุงุฑ AUC ุชูุธู ูโฺฉูุฏ.
- `grid on` ุฎุทูุท ูุดุจฺฉ ุฑุง ููุงุด ูโุฏูุฏ.

```matlab
end
```
**ุฎุท ตท:** ูพุงุงู ุชุงุจุน.

---

## ฺุฑุง ุงู ูุนุงุฑูุง ููู ูุณุชูุฏุ

ุฏุฑ ูพุฒุดฺฉุ ููู ูุนุงุฑูุง ููู ูุณุชูุฏ:

- **Accuracy** ุฎูุจ ุงุณุช ุงูุง ฺฉุงู ูุณุช (ูุซูุงู ุงฺฏุฑ ููู ุฑุง ุณุงูู ุชุดุฎุต ุฏููุ ุจุงุฒ ูู ถตูช ุฏูุช ุฏุงุฑู!).
- **Sensitivity** ููู ุงุณุช ฺูู ููโุฎูุงูู ุจูุงุฑ ุฑุง ุงุฒ ุฏุณุช ุจุฏูู.
- **Precision** ููู ุงุณุช ฺูู ููโุฎูุงูู ุจู ุงูุฑุงุฏ ุณุงูู ุจฺฏูู ุจูุงุฑ ูุณุชูุฏ.
- **F1-Score** ุชุนุงุฏู ุจู ุงู ุฏู ุฑุง ูโุณูุฌุฏ.
- **ROC Curve** ูุดุงู ูโุฏูุฏ ูุฏู ุฏุฑ ุขุณุชุงููโูุง ูุฎุชูู ฺูุฏุฑ ุฎูุจ ุนูู ูโฺฉูุฏ.
