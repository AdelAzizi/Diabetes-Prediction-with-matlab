# توضیح فایل `load_data.m`

این تابع مسئول **بارگذاری امن داده‌ها از فایل CSV** و تبدیل آن به یک جدول منظم در متلب است.

---

## ورودی و خروجی

- **ورودی (`filePath`)**: مسیر فایل `diabetes.csv` (مثلاً `data/diabetes.csv`).
- **خروجی (`dataTable`)**: یک جدول متلب که هر سطر آن یک بیمار و هر ستون آن یک ویژگی (قند خون، فشار خون، سن، ... ) است.

---

## مرحله‌به‌مرحله چه کار می‌کند؟

### ۱. بررسی وجود فایل
- با `isfile(filePath)` چک می‌کند که فایل واقعاً در آن مسیر هست یا نه.
- اگر نبود، دستور `error(...)` اجرا می‌شود و پیغام خطای فارسی نشان می‌دهد و برنامه متوقف می‌شود.

### ۲. نمایش پیام وضعیت
- با `fprintf` اعلام می‌کند که «در حال خواندن داده‌ها از: ...» تا بدانیم برنامه در چه مرحله‌ای است.

### ۳. تعریف نام ستون‌ها
- یک آرایه از نام ستون‌ها می‌سازد:
  - `Pregnancies`, `Glucose`, `BloodPressure`, `SkinThickness`, `Insulin`, `BMI`, `DiabetesPedigree`, `Age`, `Outcome`
- دلیلش این است که فایل خام ممکن است هدر نداشته باشد یا ناقص باشد.

### ۴. تنظیم گزینه‌های خواندن (`detectImportOptions`)
- با `detectImportOptions(filePath)` تنظیمات پیش‌فرض خواندن فایل را می‌گیرد.
- سپس:
  - `opts.VariableNamesLine = 0` یعنی سطر اول داده است، نه نام ستون‌ها.
  - `opts.PreserveVariableNames = true` یعنی نام ستون‌ها را دستکاری نکند.

### ۵. خواندن داده‌ها با `readtable`
- با `readtable(filePath, opts)` کل فایل CSV را به شکل جدول (Table) می‌خواند.

### ۶. تنظیم نام ستون‌ها روی جدول
- اگر `width(dataTable)` (تعداد ستون‌ها) برابر با تعداد نام‌هایی باشد که تعریف کرده‌ایم، آن نام‌ها روی جدول ست می‌شوند:
  - `dataTable.Properties.VariableNames = varNames;`
- اگر برابر نباشند، با `warning(...)` اخطار می‌دهد که «تعداد ستون‌ها همخوانی ندارد» تا حواسمان جمع شود.

### ۷. چاپ خلاصه ابعاد داده
- در انتها با `fprintf` تعداد سطرها (`height(dataTable)`) و ستون‌ها (`width(dataTable)`) چاپ می‌شود.
- این کمک می‌کند مطمئن شویم داده‌ها درست خوانده شده‌اند (مثلاً ۷۶۸ سطر و ۹ ستون).

---

## توضیح خط به خط کد

```matlab
function dataTable = load_data(filePath)
```
**خط ۱:** تعریف تابع. نام تابع `load_data` است. یک ورودی (`filePath`) می‌گیرد و یک خروجی (`dataTable`) برمی‌گرداند.

```matlab
    % LOAD_DATA فایل CSV را می‌خواند و هدرهای مناسب را به آن اختصاص می‌دهد.
```
**خط ۲:** یک کامنت توضیحی که می‌گوید این تابع چه کاری انجام می‌دهد.

```matlab
    % ۱. بررسی وجود فایل
    if ~isfile(filePath)
```
**خط ۱۰-۱۱:** 
- `isfile(filePath)` چک می‌کند که آیا فایل در مسیر مشخص شده وجود دارد یا نه.
- `~` یعنی "نه" یا "معکوس". پس `~isfile` یعنی "اگر فایل وجود نداشت".

```matlab
        error('خطا: فایل داده در مسیر زیر پیدا نشد:\n%s', filePath);
```
**خط ۱۲:** اگر فایل پیدا نشد، این خط اجرا می‌شود. `error` برنامه را متوقف می‌کند و پیغام خطا نمایش می‌دهد. `\n` یعنی یک خط جدید و `%s` جای `filePath` را می‌گیرد.

```matlab
    end
```
**خط ۱۳:** پایان دستور `if`.

```matlab
    fprintf('در حال خواندن داده‌ها از: %s ...\n', filePath);
```
**خط ۱۵:** یک پیغام روی صفحه نمایش می‌دهد که می‌گوید "در حال خواندن داده‌ها از: [مسیر فایل]". `fprintf` برای چاپ فرمت‌دار استفاده می‌شود.

```matlab
    % ۲. تعریف نام ستون‌ها (چون فایل اصلی هدر ندارد یا ممکن است ناقص باشد)
    varNames = {'Pregnancies', 'Glucose', 'BloodPressure', 'SkinThickness', ...
                'Insulin', 'BMI', 'DiabetesPedigree', 'Age', 'Outcome'};
```
**خط ۱۷-۱۹:** 
- یک آرایه سلولی (Cell Array) ساخته می‌شود که شامل نام ۹ ستون است.
- `...` در انتهای خط ۱۸ یعنی ادامه در خط بعدی (برای خوانایی بهتر).

```matlab
    % ۳. خواندن فایل با readtable
    % نکته: 'ReadVariableNames', false یعنی سطر اول داده است، نه تیتر
    opts = detectImportOptions(filePath);
```
**خط ۲۱-۲۳:** 
- `detectImportOptions` تنظیمات پیش‌فرض برای خواندن فایل CSV را تشخیص می‌دهد و در متغیر `opts` ذخیره می‌کند.

```matlab
    opts.VariableNamesLine = 0; % فایل هدر ندارد
```
**خط ۲۴:** به متلب می‌گوید که سطر اول فایل نام ستون نیست، بلکه داده است (چون فایل هدر ندارد).

```matlab
    opts.PreserveVariableNames = true;
```
**خط ۲۵:** به متلب می‌گوید که نام ستون‌ها را تغییر ندهد و همان‌طور که هستند حفظ کند.

```matlab
    dataTable = readtable(filePath, opts);
```
**خط ۲۷:** با استفاده از تنظیمات `opts`، فایل CSV را می‌خواند و در متغیر `dataTable` ذخیره می‌کند.

```matlab
    % ۴. اطمینان از اینکه تعداد ستون‌ها با نام‌ها برابر است
    if width(dataTable) == length(varNames)
```
**خط ۲۹-۳۰:** 
- `width(dataTable)` تعداد ستون‌های جدول را برمی‌گرداند.
- `length(varNames)` تعداد نام‌هایی که تعریف کردیم را برمی‌گرداند.
- اگر این دو برابر باشند، یعنی فایل درست خوانده شده است.

```matlab
        dataTable.Properties.VariableNames = varNames;
```
**خط ۳۱:** اگر تعداد ستون‌ها درست بود، نام‌های تعریف شده را به ستون‌های جدول اختصاص می‌دهد.

```matlab
    else
        warning('تعداد ستون‌های فایل با تعداد نام‌های تعریف شده همخوانی ندارد.');
```
**خط ۳۲-۳۳:** اگر تعداد ستون‌ها با نام‌ها برابر نبود، یک اخطار نمایش می‌دهد (اما برنامه متوقف نمی‌شود).

```matlab
    end
```
**خط ۳۴:** پایان دستور `if`.

```matlab
    fprintf('داده‌ها با موفقیت بارگذاری شدند. ابعاد: %d سطر و %d ستون.\n', ...
            height(dataTable), width(dataTable));
```
**خط ۳۶-۳۷:** 
- یک پیغام موفقیت نمایش می‌دهد.
- `height(dataTable)` تعداد سطرها را برمی‌گرداند.
- `width(dataTable)` تعداد ستون‌ها را برمی‌گرداند.
- `%d` برای نمایش اعداد صحیح استفاده می‌شود.

```matlab
end
```
**خط ۳۸:** پایان تابع.

---

## اگر کد را به زبان ساده بخواهیم بگوییم

- اول مطمئن می‌شود فایل وجود دارد.  
- بعد می‌گوید «این فایل دقیقاً چه ستون‌هایی باید داشته باشد؟» و اسم‌ها را تعیین می‌کند.  
- سپس فایل را می‌خواند و به شکل یک جدول منظم درمی‌آورد.  
- در پایان به شما می‌گوید: «این‌قدر سطر و این‌قدر ستون داده با موفقیت خواندم.»
