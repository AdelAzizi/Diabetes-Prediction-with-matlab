# ุชูุถุญ ูุงู `compare_models.m`

ุงู ุชุงุจุน ูุณุฆูู **ููุงุณู ฺูุฏู ูุฏู ูุฎุชูู** ู ุงูุชุฎุงุจ ุจูุชุฑู ุขูโูุง ุงุณุช.
ูพูุฌ ูุฏู ูุฎุชูู (KNNุ Treeุ Naive Bayesุ SVMุ Ensemble) ุฑุง ุขููุฒุด ูโุฏูุฏ ู ูู ุฏูุช ู ูู ุญุณุงุณุช ูุฑ ฺฉุฏุงู ุฑุง ูุญุงุณุจู ูโฺฉูุฏุ ุณูพุณ ูุฏู ฺฉู ุจูุชุฑู ุชุฑฺฉุจ ุฏูุช ู ุญุณุงุณุช ุฑุง ุฏุงุฑุฏ ุงูุชุฎุงุจ ูโฺฉูุฏ.

---

## ูุฑูุฏ ู ุฎุฑูุฌ

- **ูุฑูุฏโูุง:**
  - `X_train`: ุฏุงุฏูโูุง ุขููุฒุด (ูฺฺฏโูุง)
  - `Y_train`: ุจุฑฺุณุจโูุง ุขููุฒุด (ุฌูุงุจ ุฏุฑุณุช)
  - `X_test`: ุฏุงุฏูโูุง ุชุณุช (ูฺฺฏโูุง)
  - `Y_test`: ุจุฑฺุณุจโูุง ูุงูุน ุชุณุช (ุฌูุงุจ ุฏุฑุณุช)
- **ุฎุฑูุฌ (`bestModelName`)**: ูุงู ูุฏู ุจุฑูุฏู (ูุซูุงู `'KNN'` ุง `'Ensemble'`)

---

## ูุฑุญููโุจูโูุฑุญูู ฺู ฺฉุงุฑ ูโฺฉูุฏุ

### ฑ. ุชุนุฑู ูุณุช ูุฏูโูุง
ูพูุฌ ูุฏู ูุฎุชูู ุชุนุฑู ูโุดููุฏ: KNNุ Treeุ NBุ SVMุ Ensemble.

### ฒ. ุขููุฒุด ู ุชุณุช ูุฑ ูุฏู
ูุฑ ูุฏู ุฑู ุฏุงุฏูโูุง ุขููุฒุด ุขููุฒุด ุฏุงุฏู ูโุดูุฏ ู ุณูพุณ ุฑู ุฏุงุฏูโูุง ุชุณุช ุงูุชุญุงู ูโุดูุฏ.

### ณ. ุฐุฎุฑู ุฏูุชโูุง
ุฏูุช ูุฑ ูุฏู ุฏุฑ ฺฉ ุขุฑุงู ุฐุฎุฑู ูโุดูุฏ.

### ด. ููุงุด ูุชุงุฌ
ฺฉ ุฌุฏูู ููุงุด ุฏุงุฏู ูโุดูุฏ ฺฉู ุฏูุช ูุฑ ูุฏู ุฑุง ูุดุงู ูโุฏูุฏ.

### ต. ุงูุชุฎุงุจ ุจุฑูุฏู
ูุฏู ฺฉู ุจุงูุงุชุฑู ุฏูุช ุฑุง ุฏุงุฑุฏ ุงูุชุฎุงุจ ูโุดูุฏ.

---

## ุชูุถุญ ุฎุท ุจู ุฎุท ฺฉุฏ

```matlab
function bestModelName = compare_models(X_train, Y_train, X_test, Y_test)
```
**ุฎุท ฑ:** ุชุนุฑู ุชุงุจุน. ฺูุงุฑ ูุฑูุฏ ูโฺฏุฑุฏ ู ูุงู ูุฏู ุจุฑูุฏู ุฑุง ุจุฑูโฺฏุฑุฏุงูุฏ.

```matlab
    % COMPARE_MODELS ููุงุณู ูุฏูโูุง ุจุง ูุงูโูุง ุงุณุชุงูุฏุงุฑุฏ
    
    disp('-----------------------------------------');
    disp('๐ฅ ูุฑุญูู ฑ: ูฺฏ ุงูุชุฎุงุจ (Model Selection)');
    disp('-----------------------------------------');
```
**ุฎุท ฒ-ถ:** ฺฉุงููุช ุชูุถุญ ู ููุงุด ุนููุงู ูุฑุญูู.

```matlab
    % ูุงูโูุง ุงุณุชุงูุฏุงุฑุฏ ู ฺฉูุชุงู (ฺฉูุฏ ุญู ูุดฺฉู)
    modelNames = {'KNN', 'Tree', 'NB', 'SVM', 'Ensemble'};
```
**ุฎุท ธ-น:** 
- ฺฉ ุขุฑุงู ุณููู ุดุงูู ูุงู ต ูุฏู ุณุงุฎุชู ูโุดูุฏ.
- ุงู ูุงูโูุง ฺฉูุชุงู ู ุงุณุชุงูุฏุงุฑุฏ ูุณุชูุฏ ุชุง ุจุนุฏุงู ุจุชูุงูู ุงุฒ ุขูโูุง ุงุณุชูุงุฏู ฺฉูู.

```matlab
     accuracies = zeros(1, 5);
     sensitivities = zeros(1, 5);
```
**ุฎุท ฑฐ-ฑฑ:**
- ุฏู ุขุฑุงู ุฎุงู ุจุง ต ุฎุงูู ุณุงุฎุชู ูโุดููุฏ ฺฉู ุฏูุช ู ุญุณุงุณุช ูุฑ ูุฏู ุฏุฑ ุขูโูุง ุฐุฎุฑู ูโุดููุฏ.
- `zeros(1, 5)` ุนู ฺฉ ุขุฑุงู ฑรต ูพุฑ ุงุฒ ุตูุฑ.

```matlab
    %% ฑ. ุขููุฒุด ู ุชุณุช
    % KNN
    mdl = fitcknn(X_train, Y_train, 'NumNeighbors', 5);
```
**ุฎุท ฑด-ฑถ:**
- `%%` ฺฉ ุณฺฉุดู ุฌุฏุฏ ุงุฌุงุฏ ูโฺฉูุฏ.
- `fitcknn` ฺฉ ูุฏู KNN ุขููุฒุด ูโุฏูุฏ.
- `'NumNeighbors', 5` ุนู ุงุฒ ต ููุณุงู ุงุณุชูุงุฏู ฺฉู.

```matlab
    [accuracies(1), sensitivities(1)] = get_metrics(mdl, X_test, Y_test);
```
**ุฎุท ฑท:**
- ุชุงุจุน ฺฉูฺฉ `get_metrics` ุฏูุช ู ุญุณุงุณุช ูุฏู ุฑุง ูุญุงุณุจู ูโฺฉูุฏ.
- ูุชุงุฌ ุฏุฑ ุฎุงูู ุงูู ุขุฑุงูโูุง `accuracies` ู `sensitivities` ุฐุฎุฑู ูโุดููุฏ.

```matlab
    % Decision Tree (Tree)
    mdl = fitctree(X_train, Y_train, 'MinLeafSize', 5);
```
**ุฎุท ฑน-ฒฐ:**
- `fitctree` ฺฉ ุฏุฑุฎุช ุชุตูู ุขููุฒุด ูโุฏูุฏ.
- `'MinLeafSize', 5` ุนู ุญุฏุงูู ต ููููู ุฏุฑ ูุฑ ุจุฑฺฏ.

```matlab
    accuracies(2) = get_acc(mdl, X_test, Y_test);
```
**ุฎุท ฑน:** ุฏูุช ุฏุฑุฎุช ุชุตูู ุฏุฑ ุฎุงูู ุฏูู ุฐุฎุฑู ูโุดูุฏ.

```matlab
    % Naive Bayes (NB)
    mdl = fitcnb(X_train, Y_train);
```
**ุฎุท ฒณ-ฒด:** `fitcnb` ฺฉ ูุฏู Naive Bayes ุขููุฒุด ูโุฏูุฏ (ุจุฏูู ูพุงุฑุงูุชุฑ ุฎุงุต).

```matlab
    [accuracies(3), sensitivities(3)] = get_metrics(mdl, X_test, Y_test);
```
**ุฎุท ฒต:** ุฏูุช ู ุญุณุงุณุช Naive Bayes ุฏุฑ ุฎุงูู ุณูู ุขุฑุงูโูุง `accuracies` ู `sensitivities` ุฐุฎุฑู ูโุดููุฏ.

```matlab
    % SVM
    mdl = fitcsvm(X_train, Y_train, 'KernelFunction', 'linear', 'Standardize', true);
```
**ุฎุท ฒท-ฒธ:**
- `fitcsvm` ฺฉ ูุฏู SVM ุขููุฒุด ูโุฏูุฏ.
- `'KernelFunction', 'linear'` ุนู ุงุฒ ฺฉุฑูู ุฎุท ุงุณุชูุงุฏู ฺฉู.
- `'Standardize', true` ุนู ุฏุงุฏูโูุง ุฑุง ูุฑูุงู ฺฉู.

```matlab
    [accuracies(4), sensitivities(4)] = get_metrics(mdl, X_test, Y_test);
```
**ุฎุท ฒน:** ุฏูุช ู ุญุณุงุณุช SVM ุฏุฑ ุฎุงูู ฺูุงุฑู ุขุฑุงูโูุง `accuracies` ู `sensitivities` ุฐุฎุฑู ูโุดููุฏ.

```matlab
    % Ensemble (Random Forest)
    mdl = fitcensemble(X_train, Y_train, 'Method', 'Bag');
```
**ุฎุท ณฑ-ณฒ:**
- `fitcensemble` ฺฉ ูุฏู Ensemble (Random Forest) ุขููุฒุด ูโุฏูุฏ.
- `'Method', 'Bag'` ุนู ุงุฒ ุฑูุด Bagging ุงุณุชูุงุฏู ฺฉู.

```matlab
    [accuracies(5), sensitivities(5)] = get_metrics(mdl, X_test, Y_test);
```
**ุฎุท ณณ:** ุฏูุช ู ุญุณุงุณุช Ensemble ุฏุฑ ุฎุงูู ูพูุฌู ุขุฑุงูโูุง `accuracies` ู `sensitivities` ุฐุฎุฑู ูโุดููุฏ.

```matlab
    %% ููุงุด ูุชุงุฌ
    fprintf('\n%-15s | %-10s | %-10s\n', 'Model', 'Accuracy', 'Sensitivity');
    disp('----------------------------------------');
```
**ุฎุท ณต-ณท:**
- ฺฉ ุฌุฏูู ุจุง ุณู ุณุชูู ูโุณุงุฒุฏ: "Model"ุ "Accuracy" ู "Sensitivity".
- `%-15s` ุนู ฺฉ ุฑุดุชู ุจุง ุนุฑุถ ฑต ฺฉุงุฑุงฺฉุชุฑ ู ุชุฑุงุฒ ฺูพ.

```matlab
    for i = 1:5
        fprintf('%-15s | %.2f%%     | %.2f%%\n', modelNames{i}, accuracies(i), sensitivities(i));
    end
```
**ุฎุท ณธ-ดฐ:**
- ฺฉ ุญููู ฺฉู ุจุฑุง ูุฑ ูุฏู ฺฉ ุฎุท ุฏุฑ ุฌุฏูู ฺุงูพ ูโฺฉูุฏ.
- `modelNames{i}` ูุงู ูุฏู iุงู ุงุณุช.
- `accuracies(i)` ุฏูุช ูุฏู iุงู ุงุณุช.
- `sensitivities(i)` ุญุณุงุณุช ูุฏู iุงู ุงุณุช.
- `%.2f%%` ุนู ุนุฏุฏ ุจุง ุฏู ุฑูู ุงุนุดุงุฑ ู ุนูุงูุช ุฏุฑุตุฏ.

```matlab
    %% ุงูุชุฎุงุจ ุจุฑูุฏู ุจุง ุชุฑฺฉุจ ุฏูุช ู ุญุณุงุณุช
    % ุฏุฑ ุชุดุฎุต ุฏุงุจุชุ ุญุณุงุณุช (ูุฏุฑุช ฺฉุดู ุจูุงุฑุงู) ุจุณุงุฑ ููู ุงุณุช
    % ุจูุงุจุฑุงู ุจู ุญุณุงุณุช ูุฒู ุจุดุชุฑ (0.6) ูโุฏูู ู ุจู ุฏูุช (0.4)
    weights = [0.4, 0.6]; % [ุฏูุช, ุญุณุงุณุช]
    combined_scores = weights(1) * accuracies/100 + weights(2) * sensitivities/100;
    
    [maxScore, idx] = max(combined_scores);
```
**ุฎุท ดฒ-ดท:**
- ุงูุชุงุฒ ุชุฑฺฉุจ ุฑุง ุจุง ุชุฑฺฉุจ ุฏูุช ู ุญุณุงุณุช ูุญุงุณุจู ูโฺฉูุฏ.
- ุจู ุญุณุงุณุช ูุฒู ุจุดุชุฑ (0.6) ูโุฏูุฏ ุฒุฑุง ุฏุฑ ุชุดุฎุต ุฏุงุจุช ฺฉุดู ุจูุงุฑุงู ุจุณุงุฑ ููู ุงุณุช.
- `max` ุจุดุชุฑู ุงูุชุงุฒ ุชุฑฺฉุจ ุฑุง ูพุฏุง ูโฺฉูุฏ.
- `maxScore` ุจุดุชุฑู ุงูุชุงุฒ ุชุฑฺฉุจ ุงุณุช.
- `idx` ุงูุฏุณ (ุดูุงุฑู) ูุฏู ุจุฑูุฏู ุงุณุช (ูุซูุงู ฑ ุจุฑุง KNN ุง ต ุจุฑุง Ensemble).

```matlab
    bestModelName = char(modelNames{idx}); % ุชุจุฏู ูุทุน ุจู ุฑุดุชู ูุชู
```
**ุฎุท ดน:**
- `modelNames{idx}` ูุงู ูุฏู ุจุฑูุฏู ุฑุง ุจุฑูโฺฏุฑุฏุงูุฏ.
- `char(...)` ุขู ุฑุง ุจู ุฑุดุชู ูุชู ูุทุน ุชุจุฏู ูโฺฉูุฏ (ุจุฑุง ุงุทููุงู ุงุฒ ููุน ุฏุงุฏู).

```matlab
    fprintf('----------------------------------------\n');
    fprintf('๐ ูุฏู ุจุฑูุฏู: %s\n', bestModelName);
    fprintf('   ุฏูุช: %.2f%% | ุญุณุงุณุช: %.2f%% | ุงูุชุงุฒ ุชุฑฺฉุจ: %.3f\n', ...
        accuracies(idx), sensitivities(idx), maxScore);
```
**ุฎุท ตฑ-ตด:**
- ฺฉ ุฎุท ุฌุฏุงฺฉููุฏู ู ูพุบุงู ุจุฑูุฏู ููุงุด ูโุฏูุฏ.
- ูุงู ูุฏู ุจุฑูุฏู ู ุงูุชุงุฒูุง ุฏูุชุ ุญุณุงุณุช ู ุงูุชุงุฒ ุชุฑฺฉุจ ุขู ุฑุง ูุดุงู ูโุฏูุฏ.

```matlab
end
```
**ุฎุท ดถ:** ูพุงุงู ุชุงุจุน ุงุตู.

```matlab
function [acc, sens] = get_metrics(model, X, Y)
```
**ุฎุท ตท:** ุชุนุฑู ุชุงุจุน ฺฉูฺฉ. ุงู ุชุงุจุน ุฏูุช ู ุญุณุงุณุช ฺฉ ูุฏู ุฑุง ูุญุงุณุจู ูโฺฉูุฏ.

```matlab
    Y_pred = predict(model, X);
```
**ุฎุท ตธ:** ูุฏู ุฑุง ุฑู ุฏุงุฏูโูุง `X` ุงุฌุฑุง ูโฺฉูุฏ ู ูพุดโุจูโูุง ุฑุง ุฏุฑ `Y_pred` ุฐุฎุฑู ูโฺฉูุฏ.

```matlab
    % ูุญุงุณุจู ุฏูุช
    acc = sum(Y_pred == Y) / length(Y) * 100;
    
    % ูุญุงุณุจู ุญุณุงุณุช (Recall)
    % ุงุฌุงุฏ ูุงุชุฑุณ ุฏุฑููโุฑุฎุชฺฏ
    cm = confusionmat(Y, Y_pred);
    % [TN  FP]
    % [FN  TP]
    if size(cm, 1) >= 2 && size(cm, 2) >= 2
        TN = cm(1,1); FP = cm(1,2);
        FN = cm(2,1); TP = cm(2,2);
        
        % ุญุณุงุณุช = TP / (TP + FN)
        if (TP + FN) > 0
            sens = (TP / (TP + FN)) * 100;
        else
            sens = 0; % ุงฺฏุฑ TP + FN = 0 ุจุงุดุฏ
        end
    else
        sens = 0; % ุงฺฏุฑ ูุงุชุฑุณ ุฏุฑููโุฑุฎุชฺฏ ุจู ุฏุฑุณุช ุงุฌุงุฏ ูุดูุฏ
    end
```
**ุฎุท ถฐ-ทน:**
- ูุญุงุณุจู ุฏูุช: `Y_pred == Y` ฺฉ ุขุฑุงู ููุทู ูโุณุงุฒุฏ ฺฉู ุฏุฑ ูุฑ ุฎุงูู ฺฉู ูพุดโุจู ุฏุฑุณุช ุงุณุช `true` ู ุฏุฑ ุจูู `false` ุงุณุช. `sum(...)` ุชุนุฏุงุฏ `true`ูุง ุฑุง ูโุดูุงุฑุฏ ู ุชูุณู ุจุฑ `length(Y)` ู ุถุฑุจ ุฏุฑ ฑฐฐุ ุฏูุช ุฑุง ุจู ุฏุฑุตุฏ ูโุฏูุฏ.
- ูุญุงุณุจู ุญุณุงุณุช: ุงุฌุงุฏ ูุงุชุฑุณ ุฏุฑููโุฑุฎุชฺฏ ู ุงุณุชุฎุฑุงุฌ TPุ TNุ FPุ FN. ุณูพุณ ูุญุงุณุจู ุญุณุงุณุช = TP / (TP + FN) ฺฉู ูุดุงูโุฏููุฏู ูุฏุฑุช ฺฉุดู ุจูุงุฑุงู ุงุณุช.

```matlab
end
```
**ุฎุท ธฑ:** ูพุงุงู ุชุงุจุน ฺฉูฺฉ.

---

## ฺุฑุง ุงู ุชุงุจุน ููู ุงุณุชุ

ูุจู ุงุฒ ุงู ฺฉู ููุช ุฒุงุฏ ุตุฑู ุจูููโุณุงุฒ ฺฉ ูุฏู ุฎุงุต ฺฉููุ ุจูุชุฑ ุงุณุช ุจุจูู ฺฉุฏุงู ูุฏู ุงุณุงุณุงู ุจูุชุฑ ฺฉุงุฑ ูโฺฉูุฏ. ุฏุฑ ุชุดุฎุต ุฏุงุจุชุ ุญุณุงุณุช (ูุฏุฑุช ฺฉุดู ุจูุงุฑุงู) ุจุณุงุฑ ููู ุงุณุช ุฒุฑุง ูุงุฏุฏู ฺฏุฑูุชู ฺฉ ุจูุงุฑ ุฎุทุฑูุงฺฉ ุงุณุชุ ุจูุงุจุฑุงู ุงู ุชุงุจุน ุชุฑฺฉุจ ุงุฒ ุฏูุช ู ุญุณุงุณุช ุฑุง ุฏุฑ ูุธุฑ ูโฺฏุฑุฏ ู ุจู ุญุณุงุณุช ูุฒู ุจุดุชุฑ ูโุฏูุฏ (0.6 ูุณุจุช ุจู 0.4 ุจุฑุง ุฏูุช).

- **KNN**: ุณุงุฏู ู ุณุฑุนุ ุจุฑุง ุฏุงุฏูโูุง ุบุฑุฎุท ุฎูุจ ุงุณุช.
- **Tree**: ูุงุจู ุชูุณุฑ ุงุณุชุ ุงูุง ููฺฉู ุงุณุช Overfitting ุดูุฏ.
- **Naive Bayes**: ุณุฑุน ุงุณุชุ ุงูุง ูุฑุถุงุช ุณุงุฏูโุง ุฏุงุฑุฏ.
- **SVM**: ูุฏุฑุชููุฏ ุงุณุชุ ุงูุง ุจุฑุง ุฏุงุฏูโูุง ุจุฒุฑฺฏ ฺฉูุฏ ูโุดูุฏ.
- **Ensemble**: ูุนูููุงู ุจูุชุฑู ุฏูุช ุฑุง ุฏุงุฑุฏุ ุงูุง ูพฺุฏูโุชุฑ ุงุณุช.

ุงู ุชุงุจุน ุจู ูุง ูโฺฏูุฏ ฺฉุฏุงู ูุฏู ุจุฑุง ุฏุชุงุณุช ุฏุงุจุช ุจูุชุฑ ุงุณุชุ ุณูพุณ ูโุชูุงูู ุฑู ููุงู ูุฏู ุชูุฑฺฉุฒ ฺฉูู ู ุขู ุฑุง ุจููู ฺฉูู.

