# توضیح فایل `compare_models.m`

این تابع مسئول **مقایسه چندین مدل مختلف** و انتخاب بهترین آن‌ها است.  
پنج مدل مختلف (KNN، Tree، Naive Bayes، SVM، Ensemble) را آموزش می‌دهد و دقت هر کدام را محاسبه می‌کند، سپس مدلی که بالاترین دقت را دارد انتخاب می‌کند.

---

## ورودی و خروجی

- **ورودی‌ها:**
  - `X_train`: داده‌های آموزشی (ویژگی‌ها)
  - `Y_train`: برچسب‌های آموزشی (جواب درست)
  - `X_test`: داده‌های تست (ویژگی‌ها)
  - `Y_test`: برچسب‌های واقعی تست (جواب درست)
- **خروجی (`bestModelName`)**: نام مدل برنده (مثلاً `'KNN'` یا `'Ensemble'`)

---

## مرحله‌به‌مرحله چه کار می‌کند؟

### ۱. تعریف لیست مدل‌ها
پنج مدل مختلف تعریف می‌شوند: KNN، Tree، NB، SVM، Ensemble.

### ۲. آموزش و تست هر مدل
هر مدل روی داده‌های آموزشی آموزش داده می‌شود و سپس روی داده‌های تست امتحان می‌شود.

### ۳. ذخیره دقت‌ها
دقت هر مدل در یک آرایه ذخیره می‌شود.

### ۴. نمایش نتایج
یک جدول نمایش داده می‌شود که دقت هر مدل را نشان می‌دهد.

### ۵. انتخاب برنده
مدلی که بالاترین دقت را دارد انتخاب می‌شود.

---

## توضیح خط به خط کد

```matlab
function bestModelName = compare_models(X_train, Y_train, X_test, Y_test)
```
**خط ۱:** تعریف تابع. چهار ورودی می‌گیرد و نام مدل برنده را برمی‌گرداند.

```matlab
    % COMPARE_MODELS مقایسه مدل‌ها با نام‌های استاندارد
    
    disp('-----------------------------------------');
    disp('🥊 مرحله ۱: لیگ انتخابی (Model Selection)');
    disp('-----------------------------------------');
```
**خط ۲-۶:** کامنت توضیحی و نمایش عنوان مرحله.

```matlab
    % نام‌های استاندارد و کوتاه (کلید حل مشکل)
    modelNames = {'KNN', 'Tree', 'NB', 'SVM', 'Ensemble'};
```
**خط ۸-۹:** 
- یک آرایه سلولی شامل نام ۵ مدل ساخته می‌شود.
- این نام‌ها کوتاه و استاندارد هستند تا بعداً بتوانیم از آن‌ها استفاده کنیم.

```matlab
    accuracies = zeros(1, 5);
```
**خط ۱۰:** 
- یک آرایه خالی با ۵ خانه ساخته می‌شود که دقت هر مدل در آن ذخیره می‌شود.
- `zeros(1, 5)` یعنی یک آرایه ۱×۵ پر از صفر.

```matlab
    %% ۱. آموزش و تست
    % KNN
    mdl = fitcknn(X_train, Y_train, 'NumNeighbors', 5);
```
**خط ۱۲-۱۴:** 
- `%%` یک سکشن جدید ایجاد می‌کند.
- `fitcknn` یک مدل KNN آموزش می‌دهد.
- `'NumNeighbors', 5` یعنی از ۵ همسایه استفاده کن.

```matlab
    accuracies(1) = get_acc(mdl, X_test, Y_test);
```
**خط ۱۵:** 
- تابع کمکی `get_acc` دقت مدل را محاسبه می‌کند.
- نتیجه در خانه اول آرایه `accuracies` ذخیره می‌شود.

```matlab
    % Decision Tree (Tree)
    mdl = fitctree(X_train, Y_train, 'MinLeafSize', 5);
```
**خط ۱۷-۱۸:** 
- `fitctree` یک درخت تصمیم آموزش می‌دهد.
- `'MinLeafSize', 5` یعنی حداقل ۵ نمونه در هر برگ.

```matlab
    accuracies(2) = get_acc(mdl, X_test, Y_test);
```
**خط ۱۹:** دقت درخت تصمیم در خانه دوم ذخیره می‌شود.

```matlab
    % Naive Bayes (NB)
    mdl = fitcnb(X_train, Y_train);
```
**خط ۲۱-۲۲:** `fitcnb` یک مدل Naive Bayes آموزش می‌دهد (بدون پارامتر خاصی).

```matlab
    accuracies(3) = get_acc(mdl, X_test, Y_test);
```
**خط ۲۳:** دقت Naive Bayes در خانه سوم ذخیره می‌شود.

```matlab
    % SVM
    mdl = fitcsvm(X_train, Y_train, 'KernelFunction', 'linear', 'Standardize', true);
```
**خط ۲۵-۲۶:** 
- `fitcsvm` یک مدل SVM آموزش می‌دهد.
- `'KernelFunction', 'linear'` یعنی از کرنل خطی استفاده کن.
- `'Standardize', true` یعنی داده‌ها را نرمال کن.

```matlab
    accuracies(4) = get_acc(mdl, X_test, Y_test);
```
**خط ۲۷:** دقت SVM در خانه چهارم ذخیره می‌شود.

```matlab
    % Ensemble (Random Forest)
    mdl = fitcensemble(X_train, Y_train, 'Method', 'Bag');
```
**خط ۲۹-۳۰:** 
- `fitcensemble` یک مدل Ensemble (Random Forest) آموزش می‌دهد.
- `'Method', 'Bag'` یعنی از روش Bagging استفاده کن.

```matlab
    accuracies(5) = get_acc(mdl, X_test, Y_test);
```
**خط ۳۱:** دقت Ensemble در خانه پنجم ذخیره می‌شود.

```matlab
    %% نمایش نتایج
    fprintf('\n%-15s | %-10s\n', 'Model', 'Accuracy');
    disp('--------------------------');
```
**خط ۳۳-۳۵:** 
- یک جدول با دو ستون می‌سازد: "Model" و "Accuracy".
- `%-15s` یعنی یک رشته با عرض ۱۵ کاراکتر و تراز چپ.

```matlab
    for i = 1:5
        fprintf('%-15s | %.2f%%\n', modelNames{i}, accuracies(i));
    end
```
**خط ۳۶-۳۸:** 
- یک حلقه که برای هر مدل یک خط در جدول چاپ می‌کند.
- `modelNames{i}` نام مدل iام است.
- `accuracies(i)` دقت مدل iام است.
- `%.2f%%` یعنی عدد با دو رقم اعشار و علامت درصد.

```matlab
    %% انتخاب برنده
    [maxAcc, idx] = max(accuracies);
```
**خط ۴۰-۴۱:** 
- `max` بیشترین مقدار آرایه `accuracies` را پیدا می‌کند.
- `maxAcc` بیشترین دقت است.
- `idx` اندیس (شماره) مدل برنده است (مثلاً ۱ برای KNN یا ۵ برای Ensemble).

```matlab
    bestModelName = char(modelNames{idx}); % تبدیل قطعی به رشته متنی
```
**خط ۴۲:** 
- `modelNames{idx}` نام مدل برنده را برمی‌گرداند.
- `char(...)` آن را به رشته متنی قطعی تبدیل می‌کند (برای اطمینان از نوع داده).

```matlab
    fprintf('--------------------------\n');
    fprintf('🏆 مدل برنده: %s (دقت: %.2f%%)\n', bestModelName, maxAcc);
```
**خط ۴۴-۴۵:** 
- یک خط جداکننده و پیغام برنده نمایش می‌دهد.
- نام مدل برنده و دقت آن را نشان می‌دهد.

```matlab
end
```
**خط ۴۶:** پایان تابع اصلی.

```matlab
function acc = get_acc(model, X, Y)
```
**خط ۴۸:** تعریف تابع کمکی. این تابع دقت یک مدل را محاسبه می‌کند.

```matlab
    Y_pred = predict(model, X);
```
**خط ۴۹:** مدل را روی داده‌های `X` اجرا می‌کند و پیش‌بینی‌ها را در `Y_pred` ذخیره می‌کند.

```matlab
    acc = sum(Y_pred == Y) / length(Y) * 100;
```
**خط ۵۰:** 
- `Y_pred == Y` یک آرایه منطقی می‌سازد که در هر خانه که پیش‌بینی درست است `true` و در بقیه `false` است.
- `sum(...)` تعداد `true`ها را می‌شمارد (تعداد پیش‌بینی‌های درست).
- `length(Y)` تعداد کل نمونه‌ها است.
- تقسیم این دو و ضرب در ۱۰۰، دقت را به درصد می‌دهد.

```matlab
end
```
**خط ۵۱:** پایان تابع کمکی.

---

## چرا این تابع مهم است؟

قبل از این که وقت زیادی صرف بهینه‌سازی یک مدل خاص کنیم، بهتر است ببینیم کدام مدل اساساً بهتر کار می‌کند:

- **KNN**: ساده و سریع، برای داده‌های غیرخطی خوب است.
- **Tree**: قابل تفسیر است، اما ممکن است Overfitting شود.
- **Naive Bayes**: سریع است، اما فرضیات ساده‌ای دارد.
- **SVM**: قدرتمند است، اما برای داده‌های بزرگ کند می‌شود.
- **Ensemble**: معمولاً بهترین دقت را دارد، اما پیچیده‌تر است.

این تابع به ما می‌گوید کدام مدل برای دیتاست ما بهتر است، سپس می‌توانیم روی همان مدل تمرکز کنیم و آن را بهینه کنیم.

